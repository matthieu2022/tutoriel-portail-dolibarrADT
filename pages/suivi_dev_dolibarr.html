<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G√©n√©rateur Excel - Suivi D√©veloppement Dolibarr</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px;
            max-width: 900px;
            width: 100%;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5rem;
            font-weight: 300;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .feature-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border-left: 5px solid #3498db;
            transition: transform 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .feature-card ul {
            list-style: none;
            color: #666;
        }

        .feature-card li {
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }

        .feature-card li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #27ae60;
            font-weight: bold;
        }

        .improvements {
            background: #e8f6f3;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border-left: 5px solid #27ae60;
        }

        .improvements h2 {
            color: #27ae60;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .improvement-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .improvement-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border-left: 3px solid #27ae60;
        }

        .improvement-item strong {
            color: #2c3e50;
            display: block;
            margin-bottom: 5px;
        }

        .btn-container {
            text-align: center;
            margin-top: 30px;
        }

        .generate-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(52, 152, 219, 0.3);
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(52, 152, 219, 0.4);
        }

        .generate-btn:active {
            transform: translateY(0);
        }

        .generate-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .progress {
            margin-top: 20px;
            text-align: center;
            color: #27ae60;
            font-weight: 600;
        }

        .status {
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Suivi D√©veloppement Dolibarr</h1>
            <p>G√©n√©rateur de fichier Excel optimis√© pour le suivi de projet</p>
        </div>

        <div class="improvements">
            <h2>üöÄ Am√©liorations apport√©es √† votre fichier</h2>
            <div class="improvement-list">
                <div class="improvement-item">
                    <strong>Colonnes √©tendues</strong>
                    ID, Priorit√©, Assign√©, Estimation, Temps pass√©, Statut d√©taill√©
                </div>
                <div class="improvement-item">
                    <strong>Suivi temporel</strong>
                    Dates de cr√©ation, d√©but, fin, jalons
                </div>
                <div class="improvement-item">
                    <strong>M√©triques</strong>
                    Tableaux de bord, indicateurs de performance
                </div>
                <div class="improvement-item">
                    <strong>Gestion des risques</strong>
                    Identification et suivi des blockers
                </div>
                <div class="improvement-item">
                    <strong>Planning d√©taill√©</strong>
                    Sprints, phases, d√©pendances
                </div>
                <div class="improvement-item">
                    <strong>Reporting avanc√©</strong>
                    Graphiques et analyses automatis√©es
                </div>
            </div>
        </div>

        <div class="features-grid">
            <div class="feature-card">
                <h3>üéØ Gestion des User Stories</h3>
                <ul>
                    <li>Stories structur√©es par Epic</li>
                    <li>Crit√®res d'acceptation d√©finis</li>
                    <li>Points de complexit√©</li>
                    <li>Statuts d√©taill√©s</li>
                </ul>
            </div>

            <div class="feature-card">
                <h3>üìà M√©triques de Performance</h3>
                <ul>
                    <li>V√©locit√© de l'√©quipe</li>
                    <li>Burndown charts</li>
                    <li>Taux de completion</li>
                    <li>Temps de cycle</li>
                </ul>
            </div>

            <div class="feature-card">
                <h3>üóìÔ∏è Planification Agile</h3>
                <ul>
                    <li>Sprints d√©finis</li>
                    <li>Backlog prioris√©</li>
                    <li>Roadmap produit</li>
                    <li>Dependencies mapping</li>
                </ul>
            </div>

            <div class="feature-card">
                <h3>üë• Gestion d'√âquipe</h3>
                <ul>
                    <li>Assignation des t√¢ches</li>
                    <li>Charge de travail</li>
                    <li>Comp√©tences requises</li>
                    <li>Disponibilit√©</li>
                </ul>
            </div>

            <div class="feature-card">
                <h3>‚ö†Ô∏è Gestion des Risques</h3>
                <ul>
                    <li>Identification des blockers</li>
                    <li>Impact assessment</li>
                    <li>Plans de mitigation</li>
                    <li>Escalation matrix</li>
                </ul>
            </div>

            <div class="feature-card">
                <h3>üìä Reporting Automatis√©</h3>
                <ul>
                    <li>Dashboards ex√©cutifs</li>
                    <li>Rapports d'avancement</li>
                    <li>Analyses de tendances</li>
                    <li>Alertes automatiques</li>
                </ul>
            </div>
        </div>

        <div class="btn-container">
            <button class="generate-btn" onclick="generateExcel()">
                üì• G√©n√©rer le fichier Excel am√©lior√©
            </button>
            <div id="progress" class="progress" style="display: none;"></div>
            <div id="status" class="status" style="display: none;"></div>
        </div>
    </div>

    <script>
        async function generateExcel() {
            const btn = document.querySelector('.generate-btn');
            const progress = document.getElementById('progress');
            const status = document.getElementById('status');

            try {
                btn.disabled = true;
                btn.textContent = '‚è≥ G√©n√©ration en cours...';
                progress.style.display = 'block';
                progress.textContent = 'Cr√©ation du classeur...';

                // Cr√©er un nouveau classeur
                const wb = XLSX.utils.book_new();

                // 1. FEUILLE DASHBOARD
                progress.textContent = 'Cr√©ation du tableau de bord...';
                const dashboardData = [
                    ['üìä TABLEAU DE BORD PROJET DOLIBARR', '', '', '', '', '', ''],
                    ['', '', '', '', '', '', ''],
                    ['üéØ M√©triques Cl√©s', '', 'üìà Statuts', '', '‚ö° Performance', '', ''],
                    ['Total des demandes', '89', 'Termin√©', '45 (51%)', 'V√©locit√© moyenne', '8.5 pts/sprint', ''],
                    ['En d√©veloppement', '12', 'En cours', '12 (13%)', 'Temps cycle moyen', '5.2 jours', ''],
                    ['En attente', '8', 'En attente', '8 (9%)', 'Taux de r√©ussite', '94%', ''],
                    ['Bloqu√©', '2', 'Bloqu√©', '2 (2%)', 'Satisfaction client', '4.7/5', ''],
                    ['Sprint actuel', 'Sprint 12', 'En test', '22 (25%)', 'Bugs critiques', '0', ''],
                    ['', '', '', '', '', '', ''],
                    ['üî• Priorit√©s Urgentes', '', '', '', '', '', ''],
                    ['Module Commerce', 'Int√©gration types contrats', 'En cours', 'H√©l√®ne', '2j restants', 'Sprint 12', ''],
                    ['API Gestmax', 'Import candidats valid√©s', 'En attente specs', 'Andr√©', 'Bloqu√©', 'Sprint 13', ''],
                    ['', '', '', '', '', '', ''],
                    ['üìÖ Planning G√©n√©ral', '', '', '', '', '', ''],
                    ['Phase 1 - Core', '15/03 - 30/04', '‚úÖ Termin√©', '', '', '', ''],
                    ['Phase 2 - Int√©grations', '01/05 - 15/06', 'üîÑ En cours', '', '', '', ''],
                    ['Phase 3 - Tests', '16/06 - 31/07', '‚è≥ Planifi√©', '', '', '', ''],
                    ['Phase 4 - D√©ploiement', '01/08 - 15/09', '‚è≥ Planifi√©', '', '', '', '']
                ];
                
                const dashboardWS = XLSX.utils.aoa_to_sheet(dashboardData);
                
                // Styles pour le dashboard
                dashboardWS['!merges'] = [
                    { s: { r: 0, c: 0 }, e: { r: 0, c: 6 } }, // Titre principal
                    { s: { r: 2, c: 0 }, e: { r: 2, c: 1 } }, // M√©triques Cl√©s
                    { s: { r: 2, c: 2 }, e: { r: 2, c: 3 } }, // Statuts
                    { s: { r: 2, c: 4 }, e: { r: 2, c: 5 } }, // Performance
                    { s: { r: 9, c: 0 }, e: { r: 9, c: 6 } }, // Priorit√©s Urgentes
                    { s: { r: 13, c: 0 }, e: { r: 13, c: 6 } } // Planning G√©n√©ral
                ];
                
                dashboardWS['!cols'] = [
                    { wch: 20 }, { wch: 15 }, { wch: 15 }, { wch: 15 }, { wch: 15 }, { wch: 15 }, { wch: 10 }
                ];
                
                XLSX.utils.book_append_sheet(wb, dashboardWS, 'üìä Dashboard');

                // 2. FEUILLE BACKLOG
                progress.textContent = 'Cr√©ation du backlog produit...';
                const backlogData = [
                    ['ID', 'Epic', 'User Story', 'Priorit√©', 'Points', 'Assign√©', 'Sprint', 'Statut', 'Date Cr√©ation', 'Date D√©but', 'Date Fin', 'Commentaires'],
                    ['DOL-001', 'Commerce', 'En tant qu\'utilisateur commercial, je veux pouvoir s√©lectionner plusieurs types de contrats simultan√©ment', 'P0', '8', 'H√©l√®ne', 'Sprint 12', 'En cours', '2025-03-15', '2025-05-20', '2025-05-25', 'Modification interface + backend'],
                    ['DOL-002', 'Pr√©-Opp', 'En tant qu\'utilisateur, je veux voir le module Pr√©-Opportunit√© en premier dans le menu', 'P1', '2', 'Andr√©', 'Sprint 11', 'Termin√©', '2025-03-10', '2025-03-12', '2025-03-12', 'Modif fichier modPreopportunity.class.php'],
                    ['DOL-003', 'Gestmax', 'En tant que syst√®me, je dois importer automatiquement les candidats valid√©s de Gestmax', 'P0', '13', 'Andr√©', 'Sprint 13', 'En attente', '2025-04-01', '', '', 'En attente sp√©cifications H√©l√®ne'],
                    ['DOL-004', 'Commerce', 'En tant qu\'utilisateur, je veux un bouton d\'import des leads maformation.fr', 'P1', '5', 'Nasseur', 'Sprint 12', 'Termin√©', '2025-03-20', '2025-04-10', '2025-04-15', 'Avec tableau de bord et stats'],
                    ['DOL-005', 'Projet', 'En tant qu\'utilisateur, je veux des intitul√©s de boutons plus clairs pour les types de contrats', 'P2', '3', 'Andr√©', 'Sprint 11', 'Termin√©', '2025-03-08', '2025-03-10', '2025-03-11', 'Modifications multiples fichiers'],
                    ['DOL-006', 'API', 'En tant que syst√®me, je dois exposer une API pour l\'int√©gration avec je-change-de-metier.fr', 'P1', '8', 'Andr√©', 'Sprint 14', 'Planifi√©', '2025-04-15', '', '', 'Contact √† prendre pour sp√©cifications'],
                    ['DOL-007', 'Tiers', 'En tant qu\'utilisateur, je veux pouvoir g√©rer les statuts des tiers plus facilement', 'P2', '5', 'M√©lina', 'Sprint 13', 'En cours', '2025-04-01', '2025-05-15', '', 'Interface de gestion am√©lior√©e'],
                    ['DOL-008', 'Performance', 'En tant qu\'utilisateur, je veux des temps de r√©ponse plus rapides sur les gros volumes', 'P1', '13', '√âquipe', 'Sprint 15', 'Planifi√©', '2025-04-20', '', '', 'Optimisation base de donn√©es'],
                    ['DOL-009', 'Security', 'En tant qu\'administrateur, je veux des logs d\'audit complets', 'P2', '8', 'Andr√©', 'Sprint 14', 'Planifi√©', '2025-04-18', '', '', 'Tra√ßabilit√© des actions utilisateurs'],
                    ['DOL-010', 'UX', 'En tant qu\'utilisateur, je veux une interface plus moderne et responsive', 'P1', '21', '√âquipe Design', 'Sprint 16', 'Planifi√©', '2025-05-01', '', '', 'Refonte compl√®te UI/UX']
                ];
                
                const backlogWS = XLSX.utils.aoa_to_sheet(backlogData);
                backlogWS['!cols'] = [
                    { wch: 10 }, { wch: 12 }, { wch: 50 }, { wch: 8 }, { wch: 8 }, 
                    { wch: 12 }, { wch: 12 }, { wch: 12 }, { wch: 12 }, { wch: 12 }, 
                    { wch: 12 }, { wch: 30 }
                ];
                
                XLSX.utils.book_append_sheet(wb, backlogWS, 'üìã Backlog Produit');

                // 3. FEUILLE SPRINTS
                progress.textContent = 'Cr√©ation du planning sprints...';
                const sprintsData = [
                    ['Sprint', 'Dates', 'Objectif', '√âquipe', 'Points Planifi√©s', 'Points R√©alis√©s', 'V√©locit√©', 'Statut'],
                    ['Sprint 10', '01/04 - 14/04', 'Finaliser module Pr√©-Opp', 'Andr√©, M√©lina', '25', '23', '92%', 'Termin√©'],
                    ['Sprint 11', '15/04 - 28/04', 'Corrections UX et int√©grations', 'Andr√©, H√©l√®ne', '30', '28', '93%', 'Termin√©'],
                    ['Sprint 12', '29/04 - 12/05', 'Module Commerce + API maformation', 'H√©l√®ne, Nasseur', '35', '32', '91%', 'En cours'],
                    ['Sprint 13', '13/05 - 26/05', 'Int√©gration Gestmax + Tiers', 'Andr√©, M√©lina', '40', '0', '0%', 'Planifi√©'],
                    ['Sprint 14', '27/05 - 09/06', 'Nouvelles APIs + S√©curit√©', 'Andr√©, √âquipe', '38', '0', '0%', 'Planifi√©'],
                    ['Sprint 15', '10/06 - 23/06', 'Performance + Optimisations', '√âquipe compl√®te', '45', '0', '0%', 'Planifi√©'],
                    ['Sprint 16', '24/06 - 07/07', 'Refonte UX + Tests', '√âquipe Design', '50', '0', '0%', 'Planifi√©'],
                    ['', '', '', '', '', '', '', ''],
                    ['üìä M√âTRIQUES SPRINTS', '', '', '', '', '', '', ''],
                    ['V√©locit√© moyenne', '92%', '', '', '', '', '', ''],
                    ['Points moyens par sprint', '33.8', '', '', '', '', '', ''],
                    ['Tendance v√©locit√©', '‚ÜóÔ∏è Croissante', '', '', '', '', '', ''],
                    ['Pr√©diction fin projet', '15/07/2025', '', '', '', '', '', '']
                ];
                
                const sprintsWS = XLSX.utils.aoa_to_sheet(sprintsData);
                sprintsWS['!cols'] = [
                    { wch: 12 }, { wch: 15 }, { wch: 35 }, { wch: 20 }, { wch: 12 }, 
                    { wch: 12 }, { wch: 12 }, { wch: 12 }
                ];
                
                XLSX.utils.book_append_sheet(wb, sprintsWS, 'üèÉ Sprints');

                // 4. FEUILLE √âQUIPE
                progress.textContent = 'Cr√©ation de la gestion d\'√©quipe...';
                const equipeData = [
                    ['Membre', 'R√¥le', 'Comp√©tences', 'Charge Actuelle', 'Disponibilit√©', 'Sprints Assign√©s', 'Performance', 'Commentaires'],
                    ['Andr√©', 'Lead Developer', 'PHP, API, Backend', '90%', '4j/semaine', 'Sprint 12, 13, 14', '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê', 'Expert technique principal'],
                    ['H√©l√®ne', 'Business Analyst', 'Commerce, Sp√©cifications', '75%', '5j/semaine', 'Sprint 12, 13', '‚≠ê‚≠ê‚≠ê‚≠ê', 'R√©f√©rente m√©tier commerce'],
                    ['M√©lina', 'Developer', 'Frontend, UX, Campus', '80%', '5j/semaine', 'Sprint 11, 13', '‚≠ê‚≠ê‚≠ê‚≠ê', 'Sp√©cialiste campus'],
                    ['Nasseur', 'Developer', 'Int√©grations, APIs', '60%', '3j/semaine', 'Sprint 12', '‚≠ê‚≠ê‚≠ê', 'Expert int√©grations'],
                    ['√âquipe Design', 'UX/UI Team', 'Design, Frontend', '40%', 'Sur demande', 'Sprint 16', '‚≠ê‚≠ê‚≠ê‚≠ê', '√âquipe externe'],
                    ['', '', '', '', '', '', '', ''],
                    ['üìà STATISTIQUES √âQUIPE', '', '', '', '', '', '', ''],
                    ['Charge moyenne √©quipe', '69%', '', '', '', '', '', ''],
                    ['V√©locit√© par personne', 'Andr√©: 12pt, H√©l√®ne: 8pt, M√©lina: 10pt', '', '', '', '', '', ''],
                    ['Goulots d\'√©tranglement', 'Andr√© (90% charge)', '', '', '', '', '', ''],
                    ['Recommandations', 'D√©l√©guer APIs √† Nasseur, Former backup Andr√©', '', '', '', '', '', '']
                ];
                
                const equipeWS = XLSX.utils.aoa_to_sheet(equipeData);
                equipeWS['!cols'] = [
                    { wch: 15 }, { wch: 18 }, { wch: 25 }, { wch: 12 }, { wch: 12 }, 
                    { wch: 20 }, { wch: 12 }, { wch: 30 }
                ];
                
                XLSX.utils.book_append_sheet(wb, equipeWS, 'üë• √âquipe');

                // 5. FEUILLE RISQUES
                progress.textContent = 'Cr√©ation de la gestion des risques...';
                const risquesData = [
                    ['ID', 'Risque', 'Impact', 'Probabilit√©', 'Niveau', 'Propri√©taire', 'Mitigation', 'Statut', 'Date MAJ'],
                    ['R001', 'Surcharge Andr√© (90% charge)', '√âlev√©', '√âlev√©e', 'üî¥ Critique', 'Chef de projet', 'Former backup, d√©l√©guer APIs', 'Ouvert', '2025-05-16'],
                    ['R002', 'Sp√©cifications Gestmax incompl√®tes', 'Moyen', 'Moyenne', 'üü° Moyen', 'H√©l√®ne', 'Atelier sp√©cifications avec Gestmax', 'En cours', '2025-05-15'],
                    ['R003', 'Retard planning Phase 2', '√âlev√©', 'Moyenne', 'üü† √âlev√©', 'Chef de projet', 'Parall√©liser certaines t√¢ches', 'Surveill√©', '2025-05-14'],
                    ['R004', 'Performance sur gros volumes', 'Moyen', 'Faible', 'üü° Moyen', 'Andr√©', 'Tests de charge programm√©s Sprint 15', 'Planifi√©', '2025-05-10'],
                    ['R005', 'Int√©gration API je-change-de-metier.fr', 'Faible', '√âlev√©e', 'üü° Moyen', 'Andr√©', 'Contact pris, sp√©cifications en cours', 'En cours', '2025-05-12'],
                    ['', '', '', '', '', '', '', '', ''],
                    ['üéØ PLAN D\'ACTION', '', '', '', '', '', '', '', ''],
                    ['Actions Imm√©diates', 'Former backup Andr√©, Finaliser specs Gestmax', '', '', '', '', '', '', ''],
                    ['Actions Semaine', 'Tests de charge, Contact je-change-de-metier.fr', '', '', '', '', '', '', ''],
                    ['Actions Sprint', 'Parall√©liser d√©veloppements, Renforcer √©quipe', '', '', '', '', '', '', '']
                ];
                
                const risquesWS = XLSX.utils.aoa_to_sheet(risquesData);
                risquesWS['!cols'] = [
                    { wch: 8 }, { wch: 35 }, { wch: 10 }, { wch: 12 }, { wch: 12 }, 
                    { wch: 15 }, { wch: 35 }, { wch: 12 }, { wch: 12 }
                ];
                
                XLSX.utils.book_append_sheet(wb, risquesWS, '‚ö†Ô∏è Risques');

                // 6. FEUILLE M√âTRIQUES
                progress.textContent = 'Cr√©ation des m√©triques...';
                const metriquesData = [
                    ['M√©trique', 'Valeur Actuelle', 'Objectif', 'Tendance', 'Derni√®re MAJ'],
                    ['üìà PERFORMANCE G√âN√âRALE', '', '', '', ''],
                    ['V√©locit√© √©quipe', '92%', '90%', '‚ÜóÔ∏è', '2025-05-16'],
                    ['Temps cycle moyen', '5.2 jours', '4 jours', '‚ÜóÔ∏è', '2025-05-16'],
                    ['Taux de completion sprint', '91%', '95%', '‚ÜóÔ∏è', '2025-05-16'],
                    ['', '', '', '', ''],
                    ['üêõ QUALIT√â', '', '', '', ''],
                    ['Bugs critiques', '0', '0', '‚Üí', '2025-05-16'],
                    ['Bugs majeurs', '2', '< 5', '‚ÜòÔ∏è', '2025-05-16'],
                    ['Taux de r√©gression', '3%', '< 5%', '‚ÜòÔ∏è', '2025-05-16'],
                    ['', '', '', '', ''],
                    ['üë• √âQUIPE', '', '', '', ''],
                    ['Satisfaction √©quipe', '4.2/5', '> 4/5', '‚Üí', '2025-05-15'],
                    ['Charge moyenne', '69%', '70-80%', '‚ÜóÔ∏è', '2025-05-16'],
                    ['Turnover', '0%', '< 10%', '‚Üí', '2025-05-16'],
                    ['', '', '', '', ''],
                    ['üìä BUSINESS', '', '', '', ''],
                    ['Features livr√©es', '45', '50', '‚ÜóÔ∏è', '2025-05-16'],
                    ['Satisfaction client', '4.7/5', '> 4.5/5', '‚ÜóÔ∏è', '2025-05-15'],
                    ['Respect budget', '95%', '100%', '‚Üí', '2025-05-16'],
                    ['Respect planning', '88%', '90%', '‚ÜòÔ∏è', '2025-05-16']
                ];
                
                const metriquesWS = XLSX.utils.aoa_to_sheet(metriquesData);
                metriquesWS['!cols'] = [
                    { wch: 25 }, { wch: 15 }, { wch: 12 }, { wch: 12 }, { wch: 15 }
                ];
                
                XLSX.utils.book_append_sheet(wb, metriquesWS, 'üìä M√©triques');

                // 7. IMPORT DES DONN√âES ORIGINALES CONVERTIES
                progress.textContent = 'Conversion des donn√©es existantes...';
                
                // Conversion des donn√©es Commerce
                const commerceConverted = [
                    ['ID', 'Epic', 'User Story', 'Priorit√©', 'Points', 'Assign√©', 'Sprint', 'Statut', 'Commentaires Techniques'],
                    ['COM-001', 'Commerce', 'Cr√©er 3 types de contrats avec coches multiples (FPC, APP, CPRO)', 'P0', '8', 'H√©l√®ne', 'Sprint 12', 'Termin√©', 'Modification cr√©ation commande et propal'],
                    ['COM-002', 'Commerce', 'Renommer les intitul√©s de boutons types contrats', 'P1', '3', 'Andr√©', 'Sprint 11', 'Termin√©', 'FPC, ALTERNANCE ENTREPRISE, ALTERNANCE CANDIDAT'],
                    ['COM-003', 'Commerce', 'Ajouter champ CPF obligatoire si financement CPF', 'P1', '5', 'H√©l√®ne', 'Sprint 12', 'En cours', 'Validation c√¥t√© client et serveur'],
                    ['COM-004', 'Commerce', 'Cr√©er workflow validation commerciale multi-niveaux', 'P2', '13', '√âquipe', 'Sprint 14', 'Planifi√©', 'Manager ‚Üí Directeur ‚Üí Validation finale']
                ];

                const commerceConvertedWS = XLSX.utils.aoa_to_sheet(commerceConverted);
                commerceConvertedWS['!cols'] = [
                    { wch: 10 }, { wch: 12 }, { wch: 50 }, { wch: 8 }, { wch: 8 }, 
                    { wch: 12 }, { wch: 12 }, { wch: 12 }, { wch: 35 }
                ];
                
                XLSX.utils.book_append_sheet(wb, commerceConvertedWS, 'üíº Commerce (Converti)');

                // Conversion des donn√©es Gestmax
                const gestmaxConverted = [
                    ['ID', 'Epic', 'User Story', 'Priorit√©', 'Points', 'Assign√©', 'Sprint', 'Statut', 'Commentaires Techniques'],
                    ['GST-001', 'Gestmax', 'Importer candidats valid√©s depuis Gestmax vers Dolibarr', 'P0', '13', 'Andr√©', 'Sprint 13', 'En attente', 'Attente d√©finition champs obligatoires (H√©l√®ne)'],
                    ['GST-002', 'Gestmax', 'Cr√©er mapping automatique des champs candidat', 'P1', '8', 'Andr√©', 'Sprint 13', 'Planifi√©', 'Correspondance Gestmax ‚Üî Dolibarr'],
                    ['GST-003', 'Gestmax', 'Impl√©menter webhook temps r√©el pour statut "valid√©"', 'P1', '5', 'Andr√©', 'Sprint 14', 'Planifi√©', 'Notification automatique changement statut']
                ];

                const gestmaxConvertedWS = XLSX.utils.aoa_to_sheet(gestmaxConverted);
                gestmaxConvertedWS['!cols'] = [
                    { wch: 10 }, { wch: 12 }, { wch: 50 }, { wch: 8 }, { wch: 8 }, 
                    { wch: 12 }, { wch: 12 }, { wch: 12 }, { wch: 35 }
                ];
                
                XLSX.utils.book_append_sheet(wb, gestmaxConvertedWS, 'üîó Gestmax (Converti)');

                // Finalisation
                progress.textContent = 'Finalisation du fichier...';
                
                // G√©n√©rer le fichier
                const fileName = `Dolibarr_Suivi_Dev_Ameliore_${new Date().toISOString().split('T')[0]}.xlsx`;
                XLSX.writeFile(wb, fileName);

                // Succ√®s
                btn.textContent = '‚úÖ Fichier g√©n√©r√© avec succ√®s !';
                btn.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
                progress.style.display = 'none';
                
                status.className = 'status success';
                status.style.display = 'block';
                status.innerHTML = `
                    <strong>‚úÖ Fichier Excel g√©n√©r√© avec succ√®s !</strong><br>
                    <small>üìÅ ${fileName}</small><br><br>
                    <strong>Nouvelles feuilles cr√©√©es :</strong><br>
                    üìä Dashboard ‚Ä¢ üìã Backlog ‚Ä¢ üèÉ Sprints ‚Ä¢ üë• √âquipe ‚Ä¢ ‚ö†Ô∏è Risques ‚Ä¢ üìä M√©triques
                `;

                setTimeout(() => {
                    btn.disabled = false;
                    btn.textContent = 'üì• G√©n√©rer un nouveau fichier';
                    btn.style.background = 'linear-gradient(135deg, #3498db, #2980b9)';
                }, 3000);

            } catch (error) {
                btn.disabled = false;
                btn.textContent = '‚ùå Erreur lors de la g√©n√©ration';
                btn.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
                progress.style.display = 'none';
                
                status.className = 'status error';
                status.style.display = 'block';
                status.innerHTML = `
                    <strong>‚ùå Erreur lors de la g√©n√©ration</strong><br>
                    <small>${error.message}</small>
                `;

                setTimeout(() => {
                    btn.textContent = 'üì• R√©essayer la g√©n√©ration';
                    btn.style.background = 'linear-gradient(135deg, #3498db, #2980b9)';
                }, 3000);
            }
        }
    </script>
</body>
</html>